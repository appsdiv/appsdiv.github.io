<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#0f172a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Ù‡ÙˆØ§ÛŒ Ù¾Ø§Ú© Ù¾Ù„Ø§Ø³</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300..900&display=swap" rel="stylesheet">

<style>
    /* --- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ù„ÛŒ Ùˆ Ù…ØªØºÛŒØ±Ù‡Ø§ --- */
    :root {
        --bg-color: #0f172a;
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.8);
        --glass-bg: rgba(255, 255, 255, 0.05);
        --glass-border: rgba(255, 255, 255, 0.2);
        --glass-blur: 25px;
        --card-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        --accent-color: #34d399;
        --liquid-1: #4f46e5;
        --liquid-2: #ec4899;
    }

    body.light-mode {
        --bg-color: #f0f4f8;
        --text-primary: #1e293b;
        --text-secondary: rgba(30, 41, 59, 0.8);
        --glass-bg: rgba(255, 255, 255, 0.65);
        --glass-border: rgba(255, 255, 255, 0.8);
        --glass-blur: 35px;
        --card-shadow: 0 8px 32px 0 rgba(100, 116, 139, 0.15);
        --liquid-1: #60a5fa;
        --liquid-2: #f472b6;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }

    body {
        background-color: var(--bg-color);
        color: var(--text-primary);
        font-family: 'Vazirmatn', -apple-system, sans-serif;
        min-height: 100vh;
        overflow-x: hidden;
        transition: background-color 0.5s ease, color 0.5s ease;
        position: relative;
    }

    /* --- Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…Ø§ÛŒØ¹ (Liquid) --- */
    .liquid-blob {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        overflow: hidden; z-index: 0; pointer-events: none;
    }
    .blob {
        position: absolute; border-radius: 50%;
        filter: blur(80px); opacity: 0.6;
        animation: floatBlob 10s infinite alternate cubic-bezier(0.4, 0, 0.2, 1);
    }
    .blob-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: var(--liquid-1); }
    .blob-2 { bottom: -10%; right: -10%; width: 60vw; height: 60vw; background: var(--liquid-2); animation-delay: -5s; }
    
    @keyframes floatBlob {
        0% { transform: translate(0, 0) scale(1); }
        100% { transform: translate(20px, 40px) scale(1.1); }
    }

    /* --- Ø°Ø±Ø§Øª Ù…Ø¹Ù„Ù‚ (Ø¨Ø§Ø±Ø§Ù†/Ø¨Ø±Ù) --- */
    #particles {
        position: fixed; inset: 0; pointer-events: none; z-index: 5;
        background-image: none; background-size: 0 0;
        transition: opacity 0.5s;
    }
    body.weather-rain #particles {
        background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0 L10 10' stroke='rgba(120,120,255,0.6)' stroke-width='1'/%3E%3C/svg%3E");
        animation: rainFall 0.6s linear infinite;
    }
    body.weather-snow #particles {
        background-image: radial-gradient(white 30%, transparent 30%);
        background-size: 10px 10px;
        animation: snowFall 3s linear infinite;
    }
    @keyframes rainFall { from { background-position: 0 0; } to { background-position: -10px 400px; } }
    @keyframes snowFall { from { background-position: 0 0; } to { background-position: 30px 200px; } }

    #app {
        position: relative; z-index: 10;
        padding: max(20px, env(safe-area-inset-top)) 24px 40px 24px;
        max-width: 500px; margin: 0 auto; width: 100%;
        display: flex; flex-direction: column; gap: 24px;
        padding-bottom: 80px;
    }

    /* --- Ù‡Ø¯Ø± Ùˆ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ --- */
    header { display: flex; justify-content: space-between; align-items: center; }
    .location-pill {
        display: flex; align-items: center; gap: 10px;
        background: var(--glass-bg); border: 1px solid var(--glass-border);
        padding: 12px 24px; border-radius: 50px;
        font-size: 16px; font-weight: 900; cursor: pointer;
        backdrop-filter: blur(var(--glass-blur)); 
        box-shadow: var(--card-shadow);
        transition: 0.3s;
    }
    .header-actions { display: flex; gap: 12px; }
    .btn-circle {
        width: 48px; height: 48px; border-radius: 50%;
        background: var(--glass-bg); border: 1px solid var(--glass-border);
        display: flex; align-items: center; justify-content: center;
        color: var(--text-primary); cursor: pointer; 
        backdrop-filter: blur(var(--glass-blur));
        box-shadow: var(--card-shadow);
        transition: 0.3s;
    }
    .btn-circle:active, .location-pill:active { transform: scale(0.92); }

    /* --- Ú¯ÛŒØ¬ Ú©ÛŒÙÛŒØª Ù‡ÙˆØ§ --- */
    .hero-section {
        display: flex; flex-direction: column; align-items: center;
        position: relative; margin-top: 10px;
    }
    .gauge-wrapper { width: 280px; height: 280px; position: relative; }
    .gauge-svg { width: 100%; height: 100%; transform: rotate(-90deg); filter: drop-shadow(0 0 15px var(--accent-color)); }
    .track { fill: none; stroke: var(--glass-border); stroke-width: 18; stroke-linecap: round; }
    .progress { 
        fill: none; stroke: var(--accent-color); stroke-width: 18; stroke-linecap: round;
        stroke-dasharray: 660; stroke-dashoffset: 660;
        transition: stroke-dashoffset 1.5s cubic-bezier(0.34, 1.56, 0.64, 1), stroke 1s;
    }
    .hero-center {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        text-align: center; display: flex; flex-direction: column; align-items: center;
    }
    .hero-val { font-size: 85px; font-weight: 900; line-height: 0.9; letter-spacing: -2px; }
    .hero-label { 
        font-size: 18px; font-weight: 800; color: #fff; margin-top: 12px; 
        background: var(--accent-color); padding: 6px 16px; border-radius: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    /* --- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ (Glass Cards) --- */
    .glass-card {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: 36px; padding: 28px;
        backdrop-filter: blur(var(--glass-blur)); -webkit-backdrop-filter: blur(var(--glass-blur));
        box-shadow: var(--card-shadow);
        position: relative; overflow: hidden;
    }
    
    /* Ø§ÙÚ©Øª Ø¨Ø±Ø§Ù‚ (Shine) Ø±ÙˆÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
    .glass-card::after {
        content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transform: skewX(-25deg); pointer-events: none;
        animation: shine 6s infinite;
    }
    @keyframes shine { 0%, 80% { left: -100%; } 100% { left: 200%; } }

    /* --- Ú©Ø§Ø±Øª Ø¨ØµØ±ÛŒ Ø¢Ø¨ Ùˆ Ù‡ÙˆØ§ --- */
    .weather-visual-card {
        display: flex; flex-direction: column; align-items: center; text-align: center;
        background: linear-gradient(145deg, var(--glass-bg) 0%, rgba(255,255,255,0.01) 100%);
        padding-top: 40px;
    }
    .weather-anim-container {
        width: 160px; height: 160px; margin-bottom: 10px;
        position: relative; z-index: 2;
        filter: drop-shadow(0 15px 30px rgba(0,0,0,0.2));
    }
    .visual-temp { font-size: 72px; font-weight: 900; line-height: 1; margin-bottom: 5px; }
    .visual-desc { font-size: 20px; opacity: 0.9; margin-bottom: 25px; font-weight: 700; color: var(--accent-color); }
    
    .visual-grid {
        display: flex; gap: 15px; width: 100%; justify-content: center;
        margin-top: 15px; padding-top: 20px; border-top: 2px solid var(--glass-border);
    }
    .v-item { display: flex; flex-direction: column; align-items: center; gap: 6px; flex: 1; }
    .v-icon { font-size: 22px; }
    .v-val { font-size: 18px; font-weight: 800; }
    .v-lbl { font-size: 12px; font-weight: 500; opacity: 0.7; }

    /* --- Ú©Ø§Ø±Øª Ø¯ÙˆØ³ØªØ§Ù†Ù‡ (Ø¬Ø¯ÛŒØ¯) --- */
    .friendly-card {
        text-align: right; border-right: 6px solid #fbbf24;
        background: linear-gradient(90deg, var(--glass-bg) 0%, rgba(0,0,0,0) 100%);
    }
    .friendly-title { font-size: 18px; font-weight: 900; margin-bottom: 12px; color: #fbbf24; display: flex; align-items: center; gap: 8px; }
    .friendly-text { font-size: 15px; line-height: 1.9; font-weight: 500; text-align: justify; color: var(--text-primary); }

    /* --- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ (Ø¯Ø§Ø³ØªØ§Ù† Ùˆ Ø³Ù„Ø§Ù…Øª) --- */
    .info-title { font-size: 16px; font-weight: 900; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .info-body { font-size: 14px; line-height: 1.8; font-weight: 400; opacity: 0.9; white-space: pre-line; text-align: justify; }

    /* --- Ú¯Ø±ÛŒØ¯ Ø¢Ù„Ø§ÛŒÙ†Ø¯Ù‡â€ŒÙ‡Ø§ --- */
    .pollutant-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .p-card {
        background: var(--glass-bg); border-radius: 28px; padding: 20px;
        border: 1px solid var(--glass-border); text-align: center;
        backdrop-filter: blur(var(--glass-blur));
        display: flex; flex-direction: column; justify-content: center; align-items: center;
    }
    .p-val { font-size: 32px; font-weight: 900; margin: 10px 0; color: var(--accent-color); }

    /* --- Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ SVG --- */
    .anim-sun { animation: spin 20s linear infinite; transform-origin: center; }
    .anim-cloud { animation: float 5s ease-in-out infinite; }
    .anim-rain { animation: rainDrop 1s linear infinite; }
    .anim-snow { animation: snowDrop 3s linear infinite; }
    .anim-thunder { animation: flash 4s infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
    @keyframes rainDrop { 0% { transform: translateY(0); opacity:1; } 100% { transform: translateY(25px); opacity:0; } }
    @keyframes flash { 0%, 90%, 100% { opacity: 0; } 92%, 96% { opacity: 1; } }

    /* --- Ù„ÙˆØ¯Ø± Ùˆ Ù…ÙˆØ¯Ø§Ù„ --- */
    #loader {
        position: fixed; inset: 0; background: var(--bg-color); z-index: 200;
        display: flex; justify-content: center; align-items: center; flex-direction: column;
        transition: opacity 0.5s;
    }
    .modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 100;
        backdrop-filter: blur(20px); display: flex; justify-content: center; align-items: flex-end;
        opacity: 0; pointer-events: none; transition: 0.4s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: auto; }
    .modal-sheet {
        width: 100%; max-width: 500px; background: var(--bg-color);
        border-top-left-radius: 36px; border-top-right-radius: 36px;
        padding: 30px; transform: translateY(100%); transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
        border-top: 1px solid var(--glass-border);
    }
    .modal-overlay.open .modal-sheet { transform: translateY(0); }
    .search-input {
        background: var(--glass-bg); border: 1px solid var(--glass-border);
        padding: 18px; border-radius: 20px; color: var(--text-primary); font-family: inherit; font-weight: 700;
        font-size: 16px; width: 100%; margin-top: 20px; text-align: center;
    }
    .search-item { padding: 18px; border-bottom: 1px solid var(--glass-border); cursor: pointer; text-align: center; color: var(--text-primary); font-weight: 500; }

</style>
</head>
<body>

    <div class="liquid-blob">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
    </div>

    <div id="particles"></div>
    
    <div id="loader">
        <svg width="60" height="60" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><circle cx="12" cy="12" r="10" fill="none" stroke-dasharray="32" stroke-dashoffset="32" stroke="var(--accent-color)"><animate attributeName="stroke-dashoffset" from="64" to="0" dur="1s" repeatCount="indefinite"/></circle></svg>
        <div style="margin-top: 20px; font-size: 16px; font-weight: 700; opacity: 0.8;">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ù‚ÛŒÙ‚...</div>
    </div>

    <div class="modal-overlay" id="search-modal">
        <div class="modal-sheet">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="font-size:20px; font-weight:900;">Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù‡Ø±</span>
                <button onclick="toggleSearch(false)" style="background:none; border:none; color:var(--text-primary); font-size:24px;">âœ•</button>
            </div>
            <input type="text" class="search-input" id="city-input" placeholder="Ù†Ø§Ù… Ø´Ù‡Ø± Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." dir="rtl">
            <div id="search-list" style="margin-top:15px; max-height:300px; overflow-y:auto;"></div>
        </div>
    </div>

    <div id="app">
        <header>
            <div class="location-pill" onclick="toggleSearch(true)">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                <span id="loc-name">ØªÙ‡Ø±Ø§Ù†</span>
            </div>
            <div class="header-actions">
                <div class="btn-circle" onclick="toggleTheme()">
                    <svg id="theme-icon" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                </div>
                <div class="btn-circle" onclick="getLocation()">
                    <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 2v20M2 12h20"/><circle cx="12" cy="12" r="6"/></svg>
                </div>
            </div>
        </header>

        <div class="hero-section">
            <div class="gauge-wrapper">
                <svg class="gauge-svg" viewBox="0 0 240 240">
                    <circle class="track" cx="120" cy="120" r="110"></circle>
                    <circle id="aqi-ring" class="progress" cx="120" cy="120" r="110"></circle>
                </svg>
                <div class="hero-center">
                    <div class="hero-val" id="aqi-val">--</div>
                    <div class="hero-label" id="aqi-text">...</div>
                </div>
            </div>
        </div>

        <div class="glass-card friendly-card">
            <div class="friendly-title">
                <span>ğŸ‘‹</span>
                <span>Ø§ÙˆÙ† Ø¨ÛŒØ±ÙˆÙ† Ú†Ù‡ Ø®Ø¨Ø±Ù‡ØŸ</span>
            </div>
            <div class="friendly-text" id="friendly-text">
                Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø³â€ŒÙˆØ¬Ùˆ Ø§Ø² Ø§Ø¨Ø±Ù‡Ø§...
            </div>
        </div>

        <div class="glass-card weather-visual-card">
            <div class="weather-anim-container" id="weather-icon-container"></div>
            <div class="visual-temp" id="visual-temp">--Â°</div>
            <div class="visual-desc" id="visual-desc">--</div>
            
            <div class="visual-grid">
                <div class="v-item">
                    <span class="v-icon">ğŸ’§</span>
                    <span class="v-val" id="hum-val">--%</span>
                    <span class="v-lbl">Ø±Ø·ÙˆØ¨Øª</span>
                </div>
                <div class="v-item">
                    <span class="v-icon">ğŸ’¨</span>
                    <span class="v-val" id="wind-val">--</span>
                    <span class="v-lbl">Ø¨Ø§Ø¯ (km)</span>
                </div>
            </div>
        </div>

        <div class="glass-card info-card" style="border-right: 6px solid var(--accent-color);">
            <div class="info-title" style="color:var(--accent-color);">
                <span>ğŸƒ</span>
                <span id="aqi-reco-head">ØªÙˆØµÛŒÙ‡ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø³Ù„Ø§Ù…ØªÛŒ</span>
            </div>
            <div class="info-body" id="aqi-reco-body">ØªØ­Ù„ÛŒÙ„ ÙˆØ¶Ø¹ÛŒØª...</div>
        </div>

        <div class="glass-card info-card" style="border-right: 6px solid #60a5fa;">
            <div class="info-title" style="color:#60a5fa;">
                <span id="story-icon">âœ¨</span>
                <span id="story-head">Ø¯Ø§Ø³ØªØ§Ù† Ù‡ÙˆØ§</span>
            </div>
            <div class="info-body" id="story-body">Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ø³Ù…Ø§Ù†...</div>
        </div>
        
        <div class="glass-card info-card" style="border-right: 6px solid #818cf8;">
            <div class="info-title" style="color:#818cf8;">
                <span>ğŸŒ§ï¸</span>
                <span>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¨Ø§Ø±Ø´</span>
            </div>
            <div>
                <div style="font-size:16px; font-weight:900;" id="rain-title">--</div>
                <div style="font-size:13px; opacity:0.8; margin-top:6px;" id="rain-desc">--</div>
            </div>
        </div>

        <div class="pollutant-grid">
            <div class="p-card">
                <span style="font-size:28px;">ğŸ˜·</span>
                <div class="p-val" id="pm25-val">--</div>
                <div style="font-size:13px; font-weight:700; opacity:0.7;">PM2.5</div>
            </div>
            <div class="p-card">
                <span style="font-size:28px;">ğŸŒ«ï¸</span>
                <div class="p-val" id="no2-val">--</div>
                <div style="font-size:13px; font-weight:700; opacity:0.7;">NOâ‚‚</div>
            </div>
        </div>

        <footer style="text-align:center; font-size:13px; font-weight:700; opacity:0.6; margin-top:30px;">
            Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø· Ù¾ÛŒÙ…Ø§Ù† Ø¹Ø§Ø¨Ø¯ÛŒÙ† Ù¾ÙˆØ±
        </footer>
    </div>

<script>
    const toFarsi = (n) => n?.toString().replace(/\d/g, d => 'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹'[d]) || '-';
    let isLight = false;

    // --- ØªØºÛŒÛŒØ± ØªÙ… (Ø¯Ø§Ø±Ú©/Ù„Ø§ÛŒØª) ---
    function toggleTheme() {
        isLight = !isLight;
        document.body.classList.toggle('light-mode');
        const icon = document.getElementById('theme-icon');
        if(isLight) {
            icon.innerHTML = '<circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>';
        } else {
            icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>';
        }
    }

    // --- ØªÙˆÙ„ÛŒØ¯ Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ù…ØªØ­Ø±Ú© SVG ---
    function getWeatherSVG(code, isDay) {
        const sunColor = "#facc15";
        const cloudColor = isLight ? "#94a3b8" : "#cbd5e1"; 
        
        if (code <= 1) return isDay ? 
            `<svg viewBox="0 0 100 100" overflow="visible"><circle cx="50" cy="50" r="22" fill="${sunColor}" filter="drop-shadow(0 0 15px ${sunColor})"><animate attributeName="r" values="22;25;22" dur="4s" repeatCount="indefinite"/></circle><g class="anim-sun" stroke="${sunColor}" stroke-width="4" stroke-linecap="round"><line x1="50" y1="10" x2="50" y2="-5"/><line x1="50" y1="90" x2="50" y2="105"/><line x1="10" y1="50" x2="-5" y2="50"/><line x1="90" y1="50" x2="105" y2="50"/><line x1="22" y1="22" x2="12" y2="12"/><line x1="78" y1="78" x2="88" y2="88"/><line x1="22" y1="78" x2="12" y2="88"/><line x1="78" y1="22" x2="88" y2="12"/></g></svg>` : 
            `<svg viewBox="0 0 100 100"><path d="M40 20 A30 30 0 1 0 80 70 A20 20 0 1 1 40 20" fill="#f1f5f9" filter="drop-shadow(0 0 15px rgba(255,255,255,0.8))"/><circle cx="65" cy="45" r="2" fill="#94a3b8" opacity="0.5"/><circle cx="50" cy="65" r="3" fill="#94a3b8" opacity="0.5"/></svg>`;
        
        if (code <= 3) return `<svg viewBox="0 0 100 100" overflow="visible"><path class="anim-cloud" d="M25,60 a20,20 0 0,1 0,-40 a20,20 0 0,1 40,0 a20,20 0 0,1 0,40 z" fill="${cloudColor}" stroke="white" stroke-width="2" filter="drop-shadow(0 10px 20px rgba(0,0,0,0.3))"/></svg>`;
        
        if (code <= 67 || code >= 80 && code <= 82) return `<svg viewBox="0 0 100 100" overflow="visible"><path class="anim-cloud" d="M25,60 a20,20 0 0,1 0,-40 a20,20 0 0,1 40,0 a20,20 0 0,1 0,40 z" fill="${cloudColor}"/><g class="anim-rain"><line x1="35" y1="65" x2="30" y2="85" stroke="#60a5fa" stroke-width="4" stroke-linecap="round"/><line x1="50" y1="65" x2="45" y2="90" stroke="#60a5fa" stroke-width="4" stroke-linecap="round"/><line x1="65" y1="65" x2="60" y2="85" stroke="#60a5fa" stroke-width="4" stroke-linecap="round"/></g></svg>`;
        
        if (code >= 71 && code <= 77 || code >= 85) return `<svg viewBox="0 0 100 100" overflow="visible"><path class="anim-cloud" d="M25,60 a20,20 0 0,1 0,-40 a20,20 0 0,1 40,0 a20,20 0 0,1 0,40 z" fill="${cloudColor}"/><g class="anim-snow"><circle cx="35" cy="75" r="4" fill="white"/><circle cx="55" cy="85" r="4" fill="white"/><circle cx="70" cy="70" r="4" fill="white"/></g></svg>`;
        
        if (code >= 95) return `<svg viewBox="0 0 100 100" overflow="visible"><path class="anim-cloud" d="M25,60 a20,20 0 0,1 0,-40 a20,20 0 0,1 40,0 a20,20 0 0,1 0,40 z" fill="#64748b"/><path class="anim-thunder" d="M45,60 L35,80 L50,80 L40,105" fill="none" stroke="#facc15" stroke-width="5" stroke-linejoin="round" filter="drop-shadow(0 0 10px #facc15)"/></svg>`;
        
        return `<svg viewBox="0 0 100 100"><g stroke="${cloudColor}" stroke-width="4" stroke-linecap="round"><line x1="20" y1="40" x2="80" y2="40"/><line x1="10" y1="60" x2="90" y2="60" opacity="0.7"/><line x1="30" y1="80" x2="70" y2="80" opacity="0.4"/></g></svg>`;
    }

    // --- ÙˆØ¶Ø¹ÛŒØª Ø¯ÙˆØ³ØªØ§Ù†Ù‡ (Ø¬Ø¯ÛŒØ¯) ---
    function getFriendlyStatus(t, wCode, wind, hum, isDay) {
        let text = "";
        text += isDay ? "Ø³Ù„Ø§Ù…! Ø±ÙˆØ²Øª Ø¨Ø®ÛŒØ±. " : "Ø³Ù„Ø§Ù…! Ø´Ø¨ Ø¨Ø®ÛŒØ±. ";
        if(t < 5) text += "Ø­Ø³Ø§Ø¨ÛŒ Ú©Ø§Ù¾Ø´Ù† Ù„Ø§Ø²Ù…Ù‡ Ú†ÙˆÙ† Ù‡ÙˆØ§ Ø³Ø±Ø¯Ù‡! ğŸ¥¶ ";
        else if(t < 15) text += "Ù‡ÙˆØ§ ÛŒÙ‡ Ú©Ù… Ø®Ù†Ú© Ùˆ Ø¯Ù„Ú†Ø³Ø¨Ù‡ØŒ Ù„Ø¨Ø§Ø³ Ú¯Ø±Ù… Ø³Ø¨Ú© Ø¨Ù¾ÙˆØ´. ğŸ§¥ ";
        else if(t < 25) text += "Ø¯Ù…Ø§ Ø¹Ø§Ù„ÛŒÙ‡ØŒ Ù†Ù‡ Ú¯Ø±Ù… Ù†Ù‡ Ø³Ø±Ø¯! Ø¬ÙˆÙ† Ù…ÛŒØ¯Ù‡ ÙˆØ§Ø³Ù‡ Ø¨ÛŒØ±ÙˆÙ† Ø±ÙØªÙ†. ğŸ˜ ";
        else if(t < 35) text += "Ù‡ÙˆØ§ Ú¯Ø±Ù…Ù‡ØŒ Ù„Ø¨Ø§Ø³ Ø®Ù†Ú© Ø¨Ù¾ÙˆØ´ Ùˆ Ø¢Ø¨ Ø¨Ø®ÙˆØ±. â˜€ï¸ ";
        else text += "Ø®ÛŒÙ„ÛŒ Ú¯Ø±Ù…Ù‡! Ù…ÙˆØ§Ø¸Ø¨ Ø¨Ø§Ø´ Ú¯Ø±Ù…Ø§Ø²Ø¯Ù‡ Ù†Ø´ÛŒ. ğŸ”¥ ";

        if(wCode <= 1) text += isDay ? "Ø¢ÙØªØ§Ø¨ Ù‚Ø´Ù†Ú¯ÛŒ ØªÙˆ Ø¢Ø³Ù…ÙˆÙ†Ù‡. " : "Ø¢Ø³Ù…ÙˆÙ† ØµØ§Ù Ùˆ Ù¾Ø± Ø³ØªØ§Ø±Ù‡â€ŒØ³Øª. ";
        else if(wCode <= 3) text += "Ø§Ø¨Ø±Ù‡Ø§ ØªÙˆ Ø¢Ø³Ù…ÙˆÙ†Ù† ÙˆÙ„ÛŒ Ø®Ø¨Ø±ÛŒ Ø§Ø² Ø¨Ø§Ø±Ø´ Ù†ÛŒØ³Øª. â˜ï¸ ";
        else if(wCode >= 51 && wCode <= 67 || wCode >= 80) text += "Ú†ØªØ± ÛŒØ§Ø¯Øª Ù†Ø±Ù‡ Ú©Ù‡ Ø¨Ø§Ø±ÙˆÙ† Ø¯Ø§Ø±Ù‡ Ù…ÛŒâ€ŒØ¨Ø§Ø±Ù‡! â˜” ";
        else if(wCode >= 71) text += "Ø¨Ø±Ù Ø¯Ø§Ø±Ù‡ Ù…ÛŒØ§Ø¯ØŒ Ø­Ø³Ø§Ø¨ÛŒ Ø®ÙˆØ´ Ø¨Ú¯Ø°Ø±Ù‡! â˜ƒï¸ ";

        if(wind > 20) text += "Ø¨Ø§Ø¯ Ù†Ø³Ø¨ØªØ§Ù‹ Ø´Ø¯ÛŒØ¯ÛŒ Ù‡Ù… Ù…ÛŒØ§Ø¯ØŒ Ù…ÙˆÙ‡Ø§ØªÙˆ Ø¨Ù‡ Ù‡Ù… Ù…ÛŒâ€ŒØ±ÛŒØ²Ù‡! ğŸ’¨ ";
        if(hum > 70) text += "Ø±Ø·ÙˆØ¨Øª Ù‡ÙˆØ§ Ù‡Ù… Ø¨Ø§Ù„Ø§Ø³Øª Ùˆ Ù…Ù…Ú©Ù†Ù‡ Ú©Ù„Ø§ÙÙ‡ Ø¨Ø´ÛŒ. ğŸ’§ ";
        else if(hum < 20) text += "Ù‡ÙˆØ§ Ø®ÛŒÙ„ÛŒ Ø®Ø´Ú©Ù‡ØŒ Ú©Ø±Ù… Ù…Ø±Ø·ÙˆØ¨ Ú©Ù†Ù†Ø¯Ù‡ Ø¨Ø²Ù†. ";
        return text;
    }

    // --- ØªÙˆØ§Ø¨Ø¹ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø´Ø¯Ù‡ (Ú©Ø§Ù…Ù„ Ùˆ Ø¯Ù‚ÛŒÙ‚) ---
    function getAirQualityMessage(aqi) {
        if (aqi <= 50) return {
            text: "Ù‡ÙˆØ§ Ø§Ù…Ø±ÙˆØ² ÙˆØ§Ù‚Ø¹Ø§Ù‹ ØªÙ…ÛŒØ² Ùˆ Ø¹Ø§Ù„ÛŒÙ‡! ğŸƒ Ø§Ù†Ú¯Ø§Ø± Ø·Ø¨ÛŒØ¹Øª Ø¯Ú©Ù…Ù‡â€ŒÛŒ Ø±ÛŒØ³Øª Ø±Ùˆ Ø²Ø¯Ù‡.\n\nØ§Ù„Ø§Ù† Ø¨Ù‡ØªØ±ÛŒÙ† ÙˆÙ‚Øª Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ù‡ Ú©Ù‡ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ø¨Ø§Ø² Ú©Ù†ÛŒ ØªØ§ Ù‡ÙˆØ§ÛŒ ØªØ§Ø²Ù‡ Ø¨Ù¾ÛŒÚ†Ù‡ ØªÙˆÛŒ Ø®ÙˆÙ†Ù‡. Ø§Ú¯Ù‡ Ø§Ù‡Ù„ ÙˆØ±Ø²Ø´ÛŒØŒ Ù¾Ø§Ø±Ú© Ùˆ Ø¯ÙˆÛŒØ¯Ù† Ø§Ù…Ø±ÙˆØ² Ø­Ø³Ø§Ø¨ÛŒ Ù…ÛŒâ€ŒÚ†Ø³Ø¨Ù‡. Ø±ÛŒÙ‡â€ŒÙ‡Ø§Øª Ø§Ù…Ø±ÙˆØ² Ø¯Ø§Ø±Ù† Ø¬Ø´Ù† Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ù†ØŒ Ù¾Ø³ Ø§Ø² Ø§ÛŒÙ† Ù‡ÙˆØ§ÛŒ Ù¾Ø§Ú© Ù†Ù‡Ø§ÛŒØª Ù„Ø°Øª Ø±Ùˆ Ø¨Ø¨Ø±."
        };
        if (aqi <= 100) return {
            text: "Ú©ÛŒÙÛŒØª Ù‡ÙˆØ§ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„Ù‡ØŒ Ø§Ù…Ø§ Ú©Ø±ÛŒØ³ØªØ§Ù„ÛŒ Ù†ÛŒØ³Øª. ğŸ˜\n\nØ§Ú¯Ù‡ Ø­Ø³Ø§Ø³ÛŒØª ÙØµÙ„ÛŒ ÛŒØ§ Ù…Ø´Ú©Ù„ ØªÙ†ÙØ³ÛŒ Ø®Ø§ØµÛŒ Ù†Ø¯Ø§Ø±ÛŒØŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø±ÙˆØ²Ù…Ø±Ù‡â€ŒØª Ø±Ùˆ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯ÛŒ. ÙˆÙ„ÛŒ Ø§Ú¯Ù‡ Ø¬Ø²Ùˆ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø³ÛŒØŒ Ø´Ø§ÛŒØ¯ Ø¨Ù‡ØªØ± Ø¨Ø§Ø´Ù‡ ØªØ§ÛŒÙ… Ø¨ÛŒØ±ÙˆÙ† Ù…ÙˆÙ†Ø¯Ù†Øª Ø±Ùˆ Ú©Ù…ØªØ± Ú©Ù†ÛŒ. Ù‡ÙˆØ§ÛŒ Ø®ÙˆÙ†Ù‡ Ø§Ù…Ù†â€ŒØªØ±Ù‡ØŒ Ù¾Ø³ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ù…Ø¯Øª Ø·ÙˆÙ„Ø§Ù†ÛŒ Ø¨Ø§Ø² Ù†Ø°Ø§Ø±."
        };
        if (aqi <= 150) return {
            text: "Ù‡ÙˆØ§ Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø³ ÛŒÙ‡â€ŒÚ©Ù… Ø³Ù†Ú¯ÛŒÙ†Ù‡. ğŸ˜·\n\nØ§Ú¯Ù‡ Ø¢Ø³Ù… Ø¯Ø§Ø±ÛŒØŒ Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒØŒ ÛŒØ§ Ø³Ù†â€ŒØª Ø¨Ø§Ù„Ø§Ø³ØªØŒ Ø§Ù…Ø±ÙˆØ² Ø±ÙˆØ²Ù Ù…ÙˆÙ†Ø¯Ù† ØªÙˆÛŒ Ø®ÙˆÙ†Ù‡ Ùˆ Ø§Ø³ØªØ±Ø§Ø­Øª Ú©Ø±Ø¯Ù†Ù‡. Ø¨Ú†Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ØªØ±Ù‡ ØªÙˆ Ø­ÛŒØ§Ø· Ø¨Ø§Ø²ÛŒ Ù†Ú©Ù†Ù†. ÙˆØ±Ø²Ø´ Ø³Ù†Ú¯ÛŒÙ† ØªÙˆ ÙØ¶Ø§ÛŒ Ø¨Ø§Ø² Ù‡Ù… Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù†Ù…ÛŒâ€ŒØ´Ù‡ Ú†ÙˆÙ† Ù…Ù…Ú©Ù†Ù‡ Ø²ÙˆØ¯ØªØ± Ø®Ø³ØªÙ‡ Ø¨Ø´ÛŒ ÛŒØ§ Ø³Ø±ÙÙ‡ Ú©Ù†ÛŒ."
        };
        if (aqi <= 200) return {
            text: "Ù‡ÙˆØ§ Ø§ØµÙ„Ø§Ù‹ Ø´ÙˆØ®ÛŒ Ù†Ø¯Ø§Ø±Ù‡! ğŸŒ«ï¸ ØºÙ„Ø¸Øª Ø¢Ù„Ø§ÛŒÙ†Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§Ù„Ø§Ø³Øª Ùˆ Ø´Ù‡Ø± Ø¯Ø§Ø±Ù‡ Ø³Ø±ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ù‡.\n\nÙ„Ø·ÙØ§Ù‹ØŒ Ù„Ø·ÙØ§Ù‹ Ø§Ú¯Ù‡ Ú©Ø§Ø± ÙˆØ§Ø¬Ø¨ÛŒ Ù†Ø¯Ø§Ø±ÛŒ Ø¨ÛŒØ±ÙˆÙ† Ù†Ø±Ùˆ. Ø§Ú¯Ù‡ Ù…Ø¬Ø¨ÙˆØ±ÛŒ Ø¨Ø±ÛŒØŒ Ø­ØªÙ…Ø§Ù‹ Ø§Ø² Ù…Ø§Ø³Ú© ÙÛŒÙ„ØªØ±Ø¯Ø§Ø± (N95) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†. Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ú©ÛŒÙ¾ Ø¨Ø¨Ù†Ø¯ Ùˆ Ù…Ø§ÛŒØ¹Ø§Øª Ùˆ Ø´ÛŒØ± Ùˆ Ø³Ø¨Ø²ÛŒØ¬Ø§Øª ØªØ§Ø²Ù‡ Ø±Ùˆ ÙØ±Ø§Ù…ÙˆØ´ Ù†Ú©Ù† ØªØ§ Ø¨Ø¯Ù†Øª Ø¨ØªÙˆÙ†Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ú©Ù†Ù‡."
        };
        return {
            text: "ÙˆØ¶Ø¹ÛŒØª Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ Ùˆ Ø®Ø·Ø±Ù†Ø§Ú©! â˜ ï¸ Ø¢Ù„ÙˆØ¯Ú¯ÛŒ Ø¨Ù‡ Ø­Ø¯ Ù‡Ø´Ø¯Ø§Ø± Ø±Ø³ÛŒØ¯Ù‡.\n\nØ§Ù„Ø§Ù† Ø§Ù…Ù†â€ŒØªØ±ÛŒÙ† Ø¬Ø§ÛŒ Ø¯Ù†ÛŒØ§ Ø®ÙˆÙ†Ù‡â€ŒØ³Øª Ø¨Ø§ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø³ØªÙ‡. Ù‡Ø± Ù†ÙˆØ¹ ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø¨ÛŒØ±ÙˆÙ† Ø§Ø² Ø®ÙˆÙ†Ù‡ Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø¨Ù‡ Ø±ÛŒÙ‡â€ŒÙ‡Ø§Øª Ø¢Ø³ÛŒØ¨ Ø¨Ø²Ù†Ù‡. Ø¯Ø³ØªÚ¯Ø§Ù‡ ØªØµÙÛŒÙ‡ Ù‡ÙˆØ§ Ø±Ùˆ Ø±ÙˆØ´Ù† Ú©Ù† Ùˆ Ù…Ø±Ø§Ù‚Ø¨ Ø®ÙˆØ¯Øª Ùˆ Ø¹Ø²ÛŒØ²Ø§Ù†Øª Ø¨Ø§Ø´. Ø§ÛŒÙ† Ù‡ÙˆØ§ Ø³Ù…ÛŒÙ‡!"
        };
    }

    function getDetailedQuote(temp, weatherCode, windSpeed, aqi, timeOfDay) {
        // 1. Ø¢Ù„ÙˆØ¯Ú¯ÛŒ Ø´Ø¯ÛŒØ¯
        if (aqi > 150) return { title: "Ø¢Ù„ÙˆØ¯Ú¯ÛŒ Ù‡ÙˆØ§ Ùˆ Ú©ÛŒÙÛŒØª Ø¨Ø¯", icon: "ğŸ˜·", text: "Ù‡ÙˆØ§ÛŒ Ø§Ù…Ø±ÙˆØ² ØªÙ…ÛŒØ² Ù†ÛŒØ³ØªØŒ Ø§Ù†Ú¯Ø§Ø± Ø´Ù‡Ø± Ø¯Ø§Ø±Ù‡ Ù†ÙØ³â€ŒÙ†ÙØ³ Ù…ÛŒâ€ŒØ²Ù†Ù‡ ğŸŒ«ï¸\n\nØªØ§ Ø¬Ø§ÛŒÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ú©Ù…ØªØ± Ø¨ÛŒØ±ÙˆÙ† Ø¨Ù…ÙˆÙ†ØŒ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ Ø±Ùˆ Ø¨Ø¨Ù†Ø¯ØŒ Ùˆ Ø§Ú¯Ø± Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ±ÙˆÙ† Ø¨Ø±ÛŒØŒ Ù…Ø§Ø³Ú© Ø±Ùˆ Ø¬Ø¯ÛŒ Ø¨Ú¯ÛŒØ±.\n\nØ¢Ø¨ Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ø®ÙˆØ± Ùˆ Ø¨Ù‡ Ø¨Ø¯Ù†Øª Ø§Ø³ØªØ±Ø§Ø­Øª Ø¨Ø¯Ù‡Ø› ØªÙˆ ÙÙ‚Ø· â€œÛŒÙ‡ Ù†ÙØ±â€ Ù†ÛŒØ³ØªÛŒØŒ ØªÙˆ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ¯Øª Ùˆ Ø¢Ø¯Ù…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù†ØŒ Ù‡Ù…Ù‡â€ŒÚ†ÛŒØ²ÛŒ." };

        // 2. Ø¨Ø±Ù
        if ([71, 73, 75, 85, 86].includes(weatherCode)) {
            if (weatherCode === 71) return { title: "Ø¨Ø±Ù Ù…Ù„Ø§ÛŒÙ… Ùˆ Ø¢Ø±Ø§Ù…", icon: "ğŸŒ¨ï¸", text: "Ø¨Ø±Ù Ø¢Ø±ÙˆÙ…â€ŒØ¢Ø±ÙˆÙ… Ø¯Ø§Ø±Ù‡ Ù…ÛŒâ€ŒØ¨Ø§Ø±Ù‡ØŒ Ø§Ø² Ø§ÙˆÙ† ØµØ­Ù†Ù‡â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø§Ú¯Ù‡ Ø­ÙˆØ§Ø³Øª Ù†Ø¨Ø§Ø´Ù‡ØŒ Ø²ÛŒØ¨Ø§ÛŒÛŒØ´ Ø±Ùˆ Ø§Ø² Ø¯Ø³Øª Ù…ÛŒâ€ŒØ¯ÛŒ â˜ƒï¸\n\nØ§Ú¯Ù‡ Ø¨Ø§ Ù…Ø§Ø´ÛŒÙ† Ù…ÛŒâ€ŒØ±ÛŒ Ø¨ÛŒØ±ÙˆÙ†ØŒ Ø²Ù†Ø¬ÛŒØ± Ú†Ø±Ø® Ùˆ ÛŒÙ‡ Ø¨Ø·Ø±ÛŒ Ø¢Ø¨ Ùˆ ÛŒÙ‡ Ø®ÙˆØ±Ø§Ú©ÛŒ Ú©ÙˆÚ†ÛŒÚ© Ø¨Ø°Ø§Ø± ØªÙˆ Ù…Ø§Ø´ÛŒÙ†Ø› Ø¨Ø±Ù Ú¯Ø§Ù‡ÛŒ Ø­ÙˆØµÙ„Ù‡â€ŒÛŒ Ù…Ø§ Ø±Ùˆ Ù‡Ù… Ø§Ù…ØªØ­Ø§Ù† Ù…ÛŒâ€ŒÚ©Ù†Ù‡.\n\nØªÙˆ Ø§ÛŒÙ† Ù‡Ù…Ù‡ Ø³ÙÛŒØ¯ÛŒ ÛŒØ§Ø¯Øª Ù†Ø±Ù‡ Ø®ÙˆØ¯Øª Ø±Ùˆ Ù‡Ù… Ø¨Ø¨ÛŒÙ†ÛŒØ› ÛŒÙ‡ Ø¹Ú©Ø³ Ø¨Ú¯ÛŒØ±ØŒ ÛŒÙ‡ Ù„Ø­Ø¸Ù‡ Ù…Ú©Ø« Ú©Ù†ØŒ Ø§ÛŒÙ† Ø±ÙˆØ²Ù‡Ø§ Ù‡Ù… ÛŒÙ‡ Ø±ÙˆØ² Ù…ÛŒâ€ŒØ´Ù† Ø®Ø§Ø·Ø±Ù‡." };
            return { title: "Ø¨Ø±Ù Ø´Ø¯ÛŒØ¯", icon: "â„ï¸", text: "Ø¨Ø±Ù Ø§Ù…Ø±ÙˆØ² Ø¯ÛŒÚ¯Ù‡ Ø´ÙˆØ®ÛŒ Ù†Ø¯Ø§Ø±Ù‡ØŒ Ø§Ù†Ú¯Ø§Ø± Ø¢Ø³Ù…ÙˆÙ† Ù‡Ù…Ù‡ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´ Ø±Ùˆ Ø¨Ø§ Ù‡Ù… Ø±ÛŒØ®ØªÙ‡ Ù¾Ø§ÛŒÛŒÙ† â›„\n\nÙ„Ø¨Ø§Ø³ Ø®ÛŒÙ„ÛŒ Ú¯Ø±Ù…ØŒ Ú©ÙØ´ Ø¶Ø¯Ø¢Ø¨ØŒ Ú©Ù„Ø§Ù‡ØŒ Ø¯Ø³ØªÚ©Ø´â€¦ Ù‡Ø±Ú†ÛŒ ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒ Ù…Ù…Ú©Ù†Ù‡ Ú©Ù…Ú© Ú©Ù†Ù‡ØŒ Ø¯Ø±ÛŒØº Ù†Ú©Ù†.\n\nØ§Ú¯Ù‡ Ø±Ø§Ù†Ù†Ø¯Ú¯ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØŒ Ø²Ù†Ø¬ÛŒØ± Ú†Ø±Ø® Ù‡Ù…Ø±Ø§Ù‡Øª Ø¨Ø§Ø´Ù‡ Ùˆ Ø­ÙˆØµÙ„Ù‡â€ŒØªÙˆ Ø²ÛŒØ§Ø¯ Ú©Ù†Ø› Ø§ÛŒÙ† Ù…Ø³ÛŒØ± Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒØªØ± Ø§Ø² Ù‡Ù…ÛŒØ´Ù‡â€ŒØ³ØªØŒ ÙˆÙ„ÛŒ ØªÙˆ Ù…Ù‡Ù…â€ŒØªØ± Ø§Ø² Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ Ù‡Ø³ØªÛŒ." };
        }

        // 3. Ø±Ø¹Ø¯ Ùˆ Ø¨Ø±Ù‚
        if ([95, 96, 99].includes(weatherCode)) return { title: "Ø±Ø¹Ø¯ Ùˆ Ø¨Ø±Ù‚", icon: "âš¡", text: "Ø±Ø¹Ø¯ Ùˆ Ø¨Ø±Ù‚ Ø¢Ø³Ù…ÙˆÙ† Ø±Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ø¯Ù‡ Ø¨Ù‡ ÛŒÚ© Ø´ÙˆÛŒ Ù†ÙˆØ± Ùˆ ØµØ¯Ø§ âš¡â›ˆï¸\n\nØªØ§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø²ÛŒØ± Ø³Ù‚Ù Ø¨Ù…ÙˆÙ†ØŒ Ùˆ Ø§Ú¯Ø± Ù…Ø¬Ø¨ÙˆØ± Ø´Ø¯ÛŒ Ø¨ÛŒØ±ÙˆÙ† Ø¨Ø±ÛŒØŒ Ø§Ø² Ø§ÛŒØ³ØªØ§Ø¯Ù† Ø²ÛŒØ± Ø¯Ø±Ø®Øªâ€ŒÙ‡Ø§ Ùˆ Ù†Ø²Ø¯ÛŒÚ© Ú©Ø§Ø¨Ù„â€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ù‚ Ø¯ÙˆØ±ÛŒ Ú©Ù†.\n\nØ§ÛŒÙ†â€ŒØ¬ÙˆØ± Ù‡ÙˆØ§Ù‡Ø§ ÛŒÙ‡ ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ Ú©ÙˆÚ†ÛŒÚ©Ù† Ú©Ù‡ Ú†Ù‚Ø¯Ø± Ø¸Ø±ÛŒÙ Ùˆ Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ÛŒÙ…Ø› Ù„Ø·ÙØ§Ù‹ Ø¨ÛŒØ´ØªØ± Ø§Ø² Ù‡Ù…ÛŒØ´Ù‡ Ù…ÙˆØ§Ø¸Ø¨ Ø®ÙˆØ¯Øª Ø¨Ø§Ø´." };

        // 4. Ø¨Ø§Ø±Ø§Ù†
        if ([51, 53, 55, 61, 63, 65, 80, 81, 82].includes(weatherCode)) {
            if ([63, 65, 81, 82].includes(weatherCode)) return { title: "Ø¨Ø§Ø±ÙˆÙ† Ø´Ø¯ÛŒØ¯", icon: "ğŸŒ§ï¸", text: "Ø§Ù…Ø±ÙˆØ² Ø¢Ø³Ù…ÙˆÙ† Ø´ÛŒØ± Ø¢Ø¨ Ø±Ùˆ Ú©Ø§Ù…Ù„ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù‡Ø› Ø¨Ø§Ø±ÙˆÙ† Ø¯Ø±Ø³Øª Ùˆ Ø­Ø³Ø§Ø¨ÛŒ Ù…ÛŒâ€ŒØ¨Ø§Ø±Ù‡ ğŸŒ§ï¸\n\nÚ†ØªØ± Ù…Ø­Ú©Ù…ØŒ Ú©ÙØ´ Ù…Ù†Ø§Ø³Ø¨ Ùˆ ÛŒÙ‡ Ú©Ù…ÛŒ Ø­ÙˆØµÙ„Ù‡â€ŒÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§ÙÛŒÚ© Ù„Ø§Ø²Ù… Ø¯Ø§Ø±ÛŒ.\n\nØ²ÙˆØ¯ØªØ± Ø§Ø² Ù‡Ù…ÛŒØ´Ù‡ Ø±Ø§Ù‡ Ø¨ÛŒÙØªØŒ Ø®ÙˆØ¯Øª Ø±Ùˆ Ø³Ø±Ø²Ù†Ø´ Ù†Ú©Ù†ØŒ Ùˆ Ø§Ú¯Ù‡ Ø¯ÛŒØ± Ø´Ø¯ØŒ Ø¨Ø¯ÙˆÙ† Ú©Ù‡ ØªÙˆ ØªÙ‚ØµÛŒØ±ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ› Ú¯Ø§Ù‡ÛŒ Ø¨Ø§ÛŒØ¯ ÙÙ‚Ø· Ù†ÙØ³ Ø¨Ú©Ø´ÛŒÙ… Ùˆ Ø¨Ú¯ÛŒÙ…: â€œØ§Ø´Ú©Ø§Ù„ Ù†Ø¯Ø§Ø±Ù‡ØŒ Ù…Ù‡Ù… Ø§ÛŒÙ†Ù‡ Ø³Ø§Ù„Ù… Ø±Ø³ÛŒØ¯Ù….â€" };
            return { title: "Ù†Ù…â€ŒÙ†Ù… Ø¨Ø§Ø±ÙˆÙ†", icon: "â˜”", text: "Ø§Ø² Ø§ÙˆÙ† Ø¨Ø§Ø±ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø±ÛŒØ² Ùˆ Ø¢Ø±ÙˆÙ…Ù‡ Ú©Ù‡ Ø¢Ø¯Ù… Ø¯Ù„Ø´ Ù…ÛŒâ€ŒØ®ÙˆØ§Ø¯ Ø²ÛŒØ±Ø´ Ø±Ø§Ù‡ Ø¨Ø±Ù‡ Ùˆ ÛŒÙ‡ Ø¢Ù‡Ù†Ú¯ Ù…Ù„Ø§ÛŒÙ… Ú¯ÙˆØ´ Ø¨Ø¯Ù‡ â˜”\n\nÚ†ØªØ± Ú©ÙˆÚ†ÛŒÚ© ÛŒØ§ ÛŒÙ‡ Ø¨Ø§Ø±ÙˆÙ†ÛŒ Ø³Ø¨Ú© Ø¨Ø±Ø¯Ø§Ø± Ú©Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø­Ø§Ù„ Ø®ÙˆØ¨ØŒ Ø¨Ø¯ÙˆÙ† Ø®ÛŒØ³ Ø´Ø¯Ù† Ú©Ø§Ù…Ù„ØŒ Ù„Ø°Øª Ø¨Ø¨Ø±ÛŒ.\n\nØ§Ú¯Ù‡ Ø­Ø³Ø´ Ø±Ùˆ Ø¯Ø§Ø´ØªÛŒØŒ Ú†Ù†Ø¯ Ø¯Ù‚ÛŒÙ‚Ù‡ Ú¯ÙˆØ´ÛŒ Ø±Ùˆ Ø¨Ø°Ø§Ø± Ú©Ù†Ø§Ø±ØŒ Ø¨Ù‡ ØµØ¯Ø§ÛŒ Ø¨Ø§Ø±ÙˆÙ† Ú¯ÙˆØ´ Ø¨Ø¯Ù‡Ø› Ù‡Ù…ÙˆÙ†â€ŒØ¬Ø§ ØªÙˆÛŒ Ø§ÙˆÙ† Ù„Ø­Ø¸Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ØŒ Ú©Ù„ÛŒ Ø¢Ø±Ø§Ù…Ø´ Ù‚Ø§ÛŒÙ… Ø´Ø¯Ù‡." };
        }

        // 5. Ù…Ù‡
        if ([45, 48].includes(weatherCode)) return { title: "Ù…Ù‡â€ŒØ¢Ù„ÙˆØ¯", icon: "ğŸŒ«ï¸", text: "Ù‡ÙˆØ§ Ø§Ù…Ø±ÙˆØ² Ù…Ù‡â€ŒØ¢Ù„ÙˆØ¯ Ùˆ Ú©Ù…ÛŒ Ø±Ø§Ø²Ø¢Ù„ÙˆØ¯ Ø´Ø¯Ù‡ØŒ Ø§Ù†Ú¯Ø§Ø± Ø´Ù‡Ø± ØªÙˆÛŒ Ø±ÙˆÛŒØ§ ÙØ±Ùˆ Ø±ÙØªÙ‡ ğŸŒ«ï¸\n\nØ§Ù…Ø§ Ø¨Ø±Ø§ÛŒ Ø±Ø§Ù†Ù†Ø¯Ú¯ÛŒ Ùˆ Ø±Ø§Ù‡ Ø±ÙØªÙ†ØŒ Ø§ÛŒÙ† Ø±ÙˆÛŒØ§ Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø®Ø·Ø±Ù†Ø§Ú© Ø¨Ø§Ø´Ù‡Ø› Ú†Ø±Ø§Øºâ€ŒÙ‡Ø§ Ø±Ùˆ Ø±ÙˆØ´Ù†â€ŒØªØ± Ú©Ù†ØŒ Ø³Ø±Ø¹ØªØª Ø±Ùˆ Ú©Ù…ØªØ± Ú©Ù† Ùˆ Ø­ÙˆØ§Ø³Øª Ø±Ùˆ Ø¨ÛŒØ´ØªØ±.\n\nØªÙˆ Ø¨Ø±Ø§ÛŒ Ø¢Ø¯Ù…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù† Ø®ÛŒÙ„ÛŒ Ù…Ù‡Ù…ÛŒØ› Ù„Ø·ÙØ§Ù‹ Ø¨Ø§ Ø§Ø­ØªÛŒØ§Ø· Ø­Ø±Ú©Øª Ú©Ù†." };

        // 6. Ø¯Ù…Ø§
        if (temp < 0) return { title: "Ù‡ÙˆØ§ÛŒ Ø®ÛŒÙ„ÛŒ Ø³Ø±Ø¯", icon: "ğŸ¥¶", text: "Ø§Ù…Ø±ÙˆØ² Ø§Ø² Ø§ÙˆÙ† Ø³ÙˆØ²Ù‡Ø§ÛŒÛŒÙ‡ Ú©Ù‡ Ø¨Ø§ Ø§ÙˆÙ„ÛŒÙ† Ù†ÙØ³ Ú©Ø´ÛŒØ¯Ù† Ù…ÛŒâ€ŒÙÙ‡Ù…ÛŒ Ø²Ù…Ø³ØªÙˆÙ† Ø¬Ø¯ÛŒ Ú¯Ø±ÙØªÙ‡ Ù‚Ø¶ÛŒÙ‡ Ø±Ùˆ ğŸ¥¶\n\nÙ‚Ø¨Ù„ Ø§Ø² Ø§ÛŒÙ†â€ŒÚ©Ù‡ Ø§Ø² Ø¯Ø± Ø¨Ø±ÛŒ Ø¨ÛŒØ±ÙˆÙ†ØŒ ÛŒÙ‡ Ú©Ù… Ø¨Ù‡ Ø®ÙˆØ¯Øª Ù…Ù‡Ø±Ø¨ÙˆÙ†ÛŒ Ú©Ù†: Ú©Ø§Ù¾Ø´Ù† Ú¯Ø±Ù…ØŒ Ø´Ø§Ù„ØŒ Ø¯Ø³ØªÚ©Ø´ØŒ Ø­ØªÛŒ Ø§Ú¯Ù‡ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒ ÛŒÙ‡ Ú©Ù„Ø§Ù‡ Ø¨Ø§Ù…Ø²Ù‡.\n\nÙ†Ø°Ø§Ø± Ø³Ø±Ù…Ø§ Ø­Ø§Ù„ Ø®ÙˆØ¨Øª Ø±Ùˆ Ø¨Ø¯Ø²Ø¯Ù‡Ø› ØªÙˆ Ù…Ù‡Ù…â€ŒØªØ± Ø§Ø² Ù‡Ù…Ù‡â€ŒÛŒ Ú©Ø§Ø±Ù‡Ø§ÛŒÛŒ Ù‡Ø³ØªÛŒ Ú©Ù‡ Ø§Ù…Ø±ÙˆØ² Ø¨Ø§ÛŒØ¯ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯ÛŒ." };
        
        if (temp > 35) return { title: "Ù‡ÙˆØ§ÛŒ Ø®ÛŒÙ„ÛŒ Ú¯Ø±Ù…", icon: "ğŸ”¥", text: "Ø§Ù…Ø±ÙˆØ² Ù‡ÙˆØ§ Ø±ÙˆÛŒ Ø­Ø§Ù„Øª â€œÚ©ÙˆØ±Ù‡â€ ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ ğŸ”¥\n\nÙ„Ø¨Ø§Ø³ Ø®ÛŒÙ„ÛŒ Ø³Ø¨Ú© Ùˆ Ø±ÙˆØ´Ù† Ø¨Ù¾ÙˆØ´ØŒ ØªØ§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ ØªÙˆ Ø³Ø§ÛŒÙ‡ Ø±Ø§Ù‡ Ø¨Ø±Ùˆ Ùˆ Ø­ØªÙ…Ø§Ù‹ ÛŒÙ‡ Ø¨Ø·Ø±ÛŒ Ø¢Ø¨ Ú©Ù†Ø§Ø±Øª Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´.\n\nØ§Ú¯Ù‡ Ø­Ø³ Ø®Ø³ØªÚ¯ÛŒØŒ Ø³Ø±Ø¯Ø±Ø¯ ÛŒØ§ Ø¨ÛŒâ€ŒØ­ÙˆØµÙ„Ú¯ÛŒ Ú©Ø±Ø¯ÛŒØŒ Ø´Ø§ÛŒØ¯ Ø¨Ø¯Ù†Ù Ù…Ù‡Ø±Ø¨ÙˆÙ†Øª Ø¯Ø§Ø±Ù‡ Ø¨Ù‡Øª Ù…ÛŒâ€ŒÚ¯Ù‡: â€œÙ„Ø·ÙØ§Ù‹ ÛŒÙ‡ Ú©Ù… Ø¢Ø¨ Ùˆ Ø§Ø³ØªØ±Ø§Ø­Øª Ø¨ÛŒØ´ØªØ±â€. Ø¨Ù‡Ø´ Ú¯ÙˆØ´ Ø¨Ø¯Ù‡." };

        if (temp > 28) return { title: "Ú¯Ø±Ù…", icon: "â˜€ï¸", text: "Ø¯Ù…Ø§ÛŒ Ù‡ÙˆØ§ ÙˆØ³Ø· Ø±ÙˆØ² ÛŒÙ‡Ùˆ Ù…ÛŒâ€ŒØ±Ù‡ Ø¨Ø§Ù„Ø§ØŒ Ø·ÙˆØ±ÛŒ Ú©Ù‡ ØµØ¨Ø­ ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒ Ø®ÙˆØ¨Ù‡ ÙˆÙ„ÛŒ Ø¸Ù‡Ø± Ø§Ø² Ú¯Ø±Ù…Ø§ Ú©Ù„Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÛŒ ğŸŒ\n\nÛŒÙ‡ Ù„Ø¨Ø§Ø³ Ø³Ø¨Ú© Ø²ÛŒØ± Ù„Ø¨Ø§Ø³Øª Ø¨Ù¾ÙˆØ´ Ú©Ù‡ Ø§Ú¯Ù‡ Ù„Ø§Ø²Ù… Ø´Ø¯ Ø¨ØªÙˆÙ†ÛŒ Ú©Ù…Ø´ Ú©Ù†ÛŒØŒ Ùˆ Ø­ØªÙ…Ø§Ù‹ ÛŒÙ‡ Ø¨Ø·Ø±ÛŒ Ø¢Ø¨ Ù‡Ù…Ø±Ø§Ù‡Øª Ø¨Ø§Ø´Ù‡.\n\nØ¨Ø¯Ù†â€ŒØª Ø¯Ø§Ø±Ù‡ Ø¨Ø±Ø§Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ØŒ ØªÙˆ Ù‡Ù… Ø¨Ø±Ú¯Ø±Ø¯ Ø¨Ø±Ø§Ø´ ÛŒÙ‡ Ú©Ù… Ù‡ÙˆØ§ÛŒ Ø®Ù†Ú© Ùˆ Ø¢Ø¨ Ù‡Ø¯ÛŒÙ‡ Ø¨Ø¯Ù‡." };

        // 7. Ø¨Ø§Ø¯
        if (windSpeed > 30) return { title: "Ø¨Ø§Ø¯ Ø´Ø¯ÛŒØ¯", icon: "ğŸ’¨", text: "Ø¨Ø§Ø¯ Ø§Ù…Ø±ÙˆØ² Ù‡Ù…Ù‡â€ŒÚ†ÛŒØ² Ø±Ùˆ Ø²ÛŒØ± Ùˆ Ø±Ùˆ Ú©Ø±Ø¯Ù‡Ø› Ø§Ø² Ù…ÙˆÙ‡Ø§ Ú¯Ø±ÙØªÙ‡ ØªØ§ Ø¨Ø±Ú¯â€ŒÙ‡Ø§ÛŒ Ø®ÛŒØ§Ø¨ÙˆÙ† ğŸ’¨\n\nØ§Ú¯Ù‡ Ù‚Ø±Ø§Ø±Ù‡ Ø¨ÛŒØ±ÙˆÙ† Ø¨Ø±ÛŒØŒ Ú©Ù„Ø§Ù‡ØŒ Ø±ÙˆØ³Ø±ÛŒ ÛŒØ§ Ù‡ÙˆØ¯ÛŒ Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ù†Ø¬Ø§Øªâ€ŒØ¯Ù‡Ù†Ø¯Ù‡â€ŒØª Ø¨Ø§Ø´Ù‡ØŒ Ùˆ Ú†ÛŒØ²Ù‡Ø§ÛŒ Ø³Ø¨Ú© Ùˆ Ø´ÙÙ„ Ø±Ùˆ Ù…Ø­Ú©Ù…â€ŒØªØ± Ù†Ú¯Ù‡ Ø¯Ø§Ø±.\n\nØ¨Ø°Ø§Ø± Ø¨Ø§Ø¯ Ù‡Ø±Ú†ÛŒ Ù…ÛŒâ€ŒØ®ÙˆØ§Ø¯ Ø¨Ø§ Ø¯Ù†ÛŒØ§ Ø¨Ú©Ù†Ù‡ØŒ Ù…Ù‡Ù… Ø§ÛŒÙ†Ù‡ ØªÙˆ ØªØ¹Ø§Ø¯Ù„ Ø®ÙˆØ¯Øª Ø±Ùˆ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒ Ùˆ Ù…Ø­Ú©Ù…â€ŒØªØ± Ø§Ø² Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ø§ÛŒØ³ØªÛŒ." };

        // 8. Ù‡ÙˆØ§ÛŒ Ø®ÙˆØ¨ / Ù…Ø¹Ù…ÙˆÙ„ÛŒ
        if (temp >= 15 && temp <= 25) return { title: "Ù‡ÙˆØ§ÛŒ Ø¯Ù„â€ŒÙ†Ø´ÛŒÙ†", icon: "ğŸŒ¼", text: "Ø§Ù…Ø±ÙˆØ² Ø§Ø² Ø§ÙˆÙ† Ø±ÙˆØ²Ù‡Ø§ÛŒÛŒâ€ŒÛŒÙ‡ Ú©Ù‡ Ù‡ÙˆØ§ Ù…ÛŒâ€ŒÚ¯Ù‡: â€œÙ…Ù† Ø­Ø§Ù„Ù… Ø®ÙˆØ¨Ù‡ØŒ Ø¨ÛŒØ§ ØªÙˆ Ù‡Ù… Ø­Ø§Ù„Øª Ø±Ùˆ Ø®ÙˆØ¨ Ú©Ù†â€ ğŸŒ¼\n\nÙ†Ù‡ Ø®ÛŒÙ„ÛŒ Ú¯Ø±Ù…Ù‡ Ù†Ù‡ Ø®ÛŒÙ„ÛŒ Ø³Ø±Ø¯Ø› ÛŒÙ‡ Ù„Ø¨Ø§Ø³ Ù…Ø¹Ù…ÙˆÙ„ÛŒ ÛŒØ§ ÛŒÙ‡ Ø³ÙˆÛŒØ´Ø±Øª Ù†Ø§Ø²Ú© Ú©Ø§ÙÛŒÙ‡.\n\nØ§Ú¯Ù‡ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ú†Ù†Ø¯ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ¯Øª Ø¨Ø±Ø¯Ø§Ø±ØŒ ÛŒÙ‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ±ÙˆÛŒ Ú©ÙˆØªØ§Ù‡ØŒ ÛŒÙ‡ Ø¨Ø³ØªÙ†ÛŒØŒ ÛŒØ§ Ø­ØªÛŒ Ù†Ø´Ø³ØªÙ† Ù¾Ø´Øª Ù¾Ù†Ø¬Ø±Ù‡ Ùˆ ØªÙ…Ø§Ø´Ø§ Ú©Ø±Ø¯Ù† Ø´Ù‡Ø±â€¦ ØªÙˆ Ù„Ø§ÛŒÙ‚ Ø§ÛŒÙ† Ø§Ø³ØªØ±Ø§Ø­ØªÛŒ." };

        return { title: "Ø§Ø¨Ø±ÛŒ Ù…Ù„Ø§ÛŒÙ…", icon: "â˜ï¸", text: "Ø¢Ø³Ù…ÙˆÙ† Ø§Ù…Ø±ÙˆØ² Ø§Ø¨Ø±ÛŒÙ‡ØŒ Ø§Ù…Ø§ Ù†Ù‡ Ø§ÙˆÙ†â€ŒÙ‚Ø¯Ø± ØªØ±Ø³Ù†Ø§Ú© Ú©Ù‡ Ø¨Ú¯Ù‡ â€œÙ†ÛŒØ§ Ø¨ÛŒØ±ÙˆÙ†â€ â˜ï¸\n\nÙ‡ÙˆØ§ÛŒ Ù…Ù„Ø§ÛŒÙ…ÛŒÙ‡Ø› ÛŒÙ‡ Ù„Ø¨Ø§Ø³ Ù…Ø¹Ù…ÙˆÙ„ÛŒØŒ Ø´Ø§ÛŒØ¯ ÛŒÙ‡ Ù„Ø§ÛŒÙ‡â€ŒÛŒ Ø³Ø¨Ú© Ø§Ø¶Ø§ÙÙ‡.\n\nØ§Ú¯Ù‡ Ø°Ù‡Ù†Øª Ø§Ù…Ø±ÙˆØ² Ú©Ù…ÛŒ Ú¯Ø±ÙØªÙ‡â€ŒØ³ØªØŒ Ø¨Ø¯ÙˆÙ† Ú©Ù‡ Ø¢Ø³Ù…Ø§Ù† Ù‡Ù… Ú¯Ø§Ù‡ÛŒ Ø§Ø¨Ø±ÛŒ Ù…ÛŒâ€ŒØ´Ù‡ØŒ Ø§Ù…Ø§ Ø¨Ø¹Ø¯Ø´ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¢Ø¨ÛŒ Ù…ÛŒâ€ŒØ´Ù‡Ø› ØªÙˆ Ù‡Ù… Ø­Ù‚ Ø¯Ø§Ø±ÛŒ Ø§ÛŒÙ†â€ŒØ·ÙˆØ±ÛŒ Ø¨Ø§Ø´ÛŒØŒ Ùˆ Ø¨Ø¹Ø¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø±ÙˆØ´Ù†â€ŒØªØ± Ø¨Ø´ÛŒ." };
    }

    function getRainMessage(probs) {
        const maxProb = Math.max(...probs);
        if (maxProb < 20) return { t: "Ø¢Ø³Ù…Ø§Ù† ØµØ§Ù ØªØ§ Ú©Ù…ÛŒ Ø§Ø¨Ø±ÛŒ", d: "Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ø§Ø±Ø´ Ø¯Ø± Û²Û´ Ø³Ø§Ø¹Øª Ø¢ÛŒÙ†Ø¯Ù‡ Ø¨Ø³ÛŒØ§Ø± Ú©Ù… Ø§Ø³Øª." };
        if (maxProb < 50) return { t: "Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ø§Ø±Ø´ Ù¾Ø±Ø§Ú©Ù†Ø¯Ù‡", d: "Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¯Ø± Ø¨Ø±Ø®ÛŒ Ø³Ø§Ø¹Ø§Øª Ø¨Ø§Ø±Ø´ Ø®ÙÛŒÙÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒÙ…." };
        if (maxProb < 80) return { t: "Ø¨Ø§Ø±Ø§Ù†ÛŒ", d: "Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ø§Ø±Ø´ Ø¨Ø§Ù„Ø§Ø³Øª. Ú†ØªØ± Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯." };
        return { t: "Ø¨Ø§Ø±Ø´ Ø´Ø¯ÛŒØ¯", d: "Ø¨Ø§Ø±Ù†Ø¯Ú¯ÛŒ Ù‚Ø§Ø¨Ù„ ØªÙˆØ¬Ù‡ÛŒ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯." };
    }

    // --- Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ ---
    function updateUI(data, city) {
        const aqi = data.aqi.current.us_aqi;
        const current = data.weather.current;
        const hour = new Date().getHours();
        const isDay = hour > 6 && hour < 19;
        const wCode = current.weather_code;

        // ØªÙ†Ø¸ÛŒÙ… Ø±Ù†Ú¯ Ùˆ ØªÙ…
        let accent = '#34d399'; 
        let status = 'Ù¾Ø§Ú©';
        document.body.classList.remove('weather-rain', 'weather-snow');

        if(aqi > 50) { accent = '#facc15'; status = 'Ø³Ø§Ù„Ù…'; }
        if(aqi > 100) { accent = '#fb923c'; status = 'Ù†Ø§Ø³Ø§Ù„Ù… Ø­Ø³Ø§Ø³'; }
        if(aqi > 150) { accent = '#f87171'; status = 'Ù†Ø§Ø³Ø§Ù„Ù…'; }
        if(aqi > 200) { accent = '#c084fc'; status = 'Ø®Ø·Ø±Ù†Ø§Ú©'; }

        if(wCode >= 95) document.body.classList.add('weather-rain');
        else if(wCode >= 51 && wCode <= 67 || wCode >= 80) document.body.classList.add('weather-rain');
        else if(wCode >= 71) document.body.classList.add('weather-snow');

        document.documentElement.style.setProperty('--accent-color', accent);
        document.documentElement.style.setProperty('--liquid-1', accent);

        // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        document.getElementById('loc-name').innerText = city;
        document.getElementById('aqi-val').innerText = toFarsi(aqi);
        document.getElementById('aqi-text').innerText = status;
        document.getElementById('aqi-text').style.backgroundColor = accent;
        
        const offset = 660 - (Math.min(aqi, 300) / 300) * 660;
        document.getElementById('aqi-ring').style.strokeDashoffset = offset;
        document.getElementById('aqi-ring').style.stroke = accent;

        // Ú©Ø§Ø±Øª Ø¨ØµØ±ÛŒ
        document.getElementById('visual-temp').innerText = toFarsi(Math.round(current.temperature_2m)) + 'Â°';
        document.getElementById('visual-desc').innerText = getDetailedQuote(current.temperature_2m, wCode, current.wind_speed_10m, aqi, hour).title;
        document.getElementById('weather-icon-container').innerHTML = getWeatherSVG(wCode, isDay);
        document.getElementById('hum-val').innerText = toFarsi(current.relative_humidity_2m) + '%';
        document.getElementById('wind-val').innerText = toFarsi(current.wind_speed_10m);

        // Ú©Ø§Ø±Øª Ø¯ÙˆØ³ØªØ§Ù†Ù‡
        document.getElementById('friendly-text').innerText = getFriendlyStatus(current.temperature_2m, wCode, current.wind_speed_10m, current.relative_humidity_2m, isDay);

        // Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ (Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø´Ø¯Ù‡)
        const aqiMsg = getAirQualityMessage(aqi);
        document.getElementById('aqi-reco-body').innerText = aqiMsg.text;

        const quote = getDetailedQuote(current.temperature_2m, wCode, current.wind_speed_10m, aqi, hour);
        document.getElementById('story-head').innerText = quote.title;
        document.getElementById('story-icon').innerText = quote.icon;
        document.getElementById('story-body').innerText = quote.text;

        const rainProbs = data.weather.hourly.precipitation_probability.slice(hour, hour+24);
        const rainInfo = getRainMessage(rainProbs);
        document.getElementById('rain-title').innerText = rainInfo.t;
        document.getElementById('rain-desc').innerText = rainInfo.d;

        document.getElementById('pm25-val').innerText = toFarsi(data.aqi.current.pm2_5);
        document.getElementById('no2-val').innerText = toFarsi(data.aqi.current.nitrogen_dioxide);

        document.getElementById('loader').style.opacity = '0';
        setTimeout(() => document.getElementById('loader').style.display = 'none', 500);
    }

    async function fetchData(lat, lon, name) {
        document.getElementById('loader').style.display = 'flex';
        document.getElementById('loader').style.opacity = '1';
        try {
            const [aqiRes, weatherRes] = await Promise.all([
                fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&current=us_aqi,pm2_5,nitrogen_dioxide&timezone=auto`),
                fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,weather_code&hourly=precipitation_probability&timezone=auto`)
            ]);
            updateUI({aqi: await aqiRes.json(), weather: await weatherRes.json()}, name);
        } catch (e) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª"); }
    }

    function toggleSearch(show) {
        const modal = document.getElementById('search-modal');
        if(show) { modal.classList.add('open'); document.getElementById('city-input').focus(); }
        else modal.classList.remove('open');
    }
    
    let debounce;
    document.getElementById('city-input').addEventListener('input', (e) => {
        clearTimeout(debounce);
        if(e.target.value.length < 2) return;
        debounce = setTimeout(async () => {
            const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${e.target.value}&count=5&language=en&format=json`);
            const data = await res.json();
            const list = document.getElementById('search-list');
            list.innerHTML = '';
            data.results?.forEach(c => {
                const div = document.createElement('div');
                div.className = 'search-item';
                div.innerText = `${c.name} (${c.country_code})`;
                div.onclick = () => { fetchData(c.latitude, c.longitude, c.name); toggleSearch(false); };
                list.appendChild(div);
            });
        }, 500);
    });

    function getLocation() {
        if(navigator.geolocation) navigator.geolocation.getCurrentPosition(p => fetchData(p.coords.latitude, p.coords.longitude, "Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ù†"));
    }

    fetchData(35.68, 51.38, "ØªÙ‡Ø±Ø§Ù†");
</script>
</body>
</html>